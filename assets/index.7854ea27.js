import{S as e,i as t,s as n,c as o,e as s,t as l,a as i,b as c,d as r,f as a,g as u,l as d,h as m,u as f,j as h,k as p,m as v,n as g,o as $,r as w,p as y,q as b,v as k,w as x,x as j,y as O,z as E,A as S,B as M,C,D as L,E as T,F as N,G as _,H as z,I as D,J as H,K as R,L as I,M as P,N as q,O as A,P as B,Q as J,R as U,T as W,U as Y}from"./vendor.f02ee216.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();function F(e){let t,n,y,b,k,x,j,O;const E=e[3].default,S=o(E,e,e[2],null);return{c(){t=s("div"),n=s("div"),y=l(e[1]),b=i(),k=s("div"),S&&S.c(),c(n,"class","ovo-btn"),c(n,"data-active",e[0]),c(k,"class","details ovo-bg ovo-bdr svelte-ikycck"),r(k,"open",e[0]),c(t,"class","drop svelte-ikycck"),c(t,"tabindex","0")},m(o,s){a(o,t,s),u(t,n),u(n,y),u(t,b),u(t,k),S&&S.m(k,null),x=!0,j||(O=[d(n,"click",e[4]),d(t,"blur",e[5])],j=!0)},p(e,[t]){(!x||2&t)&&m(y,e[1]),(!x||1&t)&&c(n,"data-active",e[0]),S&&S.p&&(!x||4&t)&&f(S,E,e,e[2],x?p(E,e[2],t,null):h(e[2]),null),1&t&&r(k,"open",e[0])},i(e){x||(v(S,e),x=!0)},o(e){g(S,e),x=!1},d(e){e&&$(t),S&&S.d(e),j=!1,w(O)}}}function G(e,t,n){let{$$slots:o={},$$scope:s}=t,{title:l=""}=t,{open:i=!1}=t;return e.$$set=e=>{"title"in e&&n(1,l=e.title),"open"in e&&n(0,i=e.open),"$$scope"in e&&n(2,s=e.$$scope)},[i,l,s,o,()=>n(0,i=!i),()=>n(0,i=!1)]}class K extends e{constructor(e){super(),t(this,e,G,F,n,{title:1,open:0})}}function Q(e){let t;return{c(){t=s("div"),t.textContent="加载中",c(t,"class","svelte-q18c5f")},m(e,n){a(e,t,n)},p:y,i:y,o:y,d(e){e&&$(t)}}}class Z extends e{constructor(e){super(),t(this,e,null,Q,n,{})}}function V(e,t,n){const o=e.slice();return o[9]=t[n],o}function X(e){return{c:y,m:y,p:y,i:y,o:y,d:y}}function ee(e){let t,n=e[8].temoji,o=[];for(let s=0;s<n.length;s+=1)o[s]=te(V(e,n,s));return{c(){t=s("ul");for(let e=0;e<o.length;e+=1)o[e].c();c(t,"class","ovo-ul svelte-11e5sht")},m(e,n){a(e,t,n);for(let s=0;s<o.length;s+=1)o[s].m(t,null)},p(e,s){if(6&s){let l;for(n=e[8].temoji,l=0;l<n.length;l+=1){const i=V(e,n,l);o[l]?o[l].p(i,s):(o[l]=te(i),o[l].c(),o[l].m(t,null))}for(;l<o.length;l+=1)o[l].d(1);o.length=n.length}},i:y,o:y,d(e){e&&$(t),S(o,e)}}}function te(e){let t,n,o,i,r,m=e[9].text+"";function f(){return e[4](e[9])}return{c(){t=s("li"),n=l(m),c(t,"title",o=e[9].title),c(t,"class","svelte-11e5sht")},m(e,o){a(e,t,o),u(t,n),i||(r=d(t,"click",f),i=!0)},p(t,n){e=t},d(e){e&&$(t),i=!1,r()}}}function ne(e){let t,n;return t=new Z({}),{c(){b(t.$$.fragment)},m(e,o){k(t,e,o),n=!0},p:y,i(e){n||(v(t.$$.fragment,e),n=!0)},o(e){g(t.$$.fragment,e),n=!1},d(e){x(t,e)}}}function oe(e){let t,n,o={ctx:e,current:null,token:null,hasCatch:!1,pending:ne,then:ee,catch:X,value:8,blocks:[,,,]};return O(e[2],o),{c(){t=s("div"),o.block.c(),c(t,"class","emoji svelte-11e5sht")},m(e,s){a(e,t,s),o.block.m(t,o.anchor=null),o.mount=()=>t,o.anchor=null,n=!0},p(t,n){E(o,e=t,n)},i(e){n||(v(o.block),n=!0)},o(e){for(let t=0;t<3;t+=1){const e=o.blocks[t];g(e)}n=!1},d(e){e&&$(t),o.block.d(),o.token=null,o=null}}}function se(e){let t,n;return t=new K({props:{title:e[0].editor.faces,$$slots:{default:[oe]},$$scope:{ctx:e}}}),{c(){b(t.$$.fragment)},m(e,o){k(t,e,o),n=!0},p(e,[n]){const o={};1&n&&(o.title=e[0].editor.faces),4096&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(v(t.$$.fragment,e),n=!0)},o(e){g(t.$$.fragment,e),n=!1},d(e){x(t,e)}}}function le(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(s,l){function i(e){try{r(o.next(e))}catch(t){l(t)}}function c(e){try{r(o.throw(e))}catch(t){l(t)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}r((o=o.apply(e,t||[])).next())}))};let{emoji:s=""}=t,{locale:l}=t;const i=j();function c(e){i("change",e)}const r=function(e){return o(this,void 0,void 0,(function*(){if(!e)throw new Error("no emoji source provided");const t=yield fetch(e);try{if(t.ok){return yield t.json()}}catch(n){throw n}}))}(s);return e.$$set=e=>{"emoji"in e&&n(3,s=e.emoji),"locale"in e&&n(0,l=e.locale)},[l,c,r,s,e=>c(e)]}class ie extends e{constructor(e){super(),t(this,e,le,se,n,{emoji:3,locale:0})}}const ce=M(null),re=M(null);function ae(e,t,n){const o=e.slice();return o[5]=t[n],o}function ue(e){let t;return{c(){t=s("div"),t.textContent="没有可以 @ 的人呢",c(t,"class","svelte-zxn7hw")},m(e,n){a(e,t,n)},p:y,d(e){e&&$(t)}}}function de(e){let t,n=e[0],o=[];for(let s=0;s<n.length;s+=1)o[s]=me(ae(e,n,s));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=L()},m(e,n){for(let t=0;t<o.length;t+=1)o[t].m(e,n);a(e,t,n)},p(e,s){if(3&s){let l;for(n=e[0],l=0;l<n.length;l+=1){const i=ae(e,n,l);o[l]?o[l].p(i,s):(o[l]=me(i),o[l].c(),o[l].m(t.parentNode,t))}for(;l<o.length;l+=1)o[l].d(1);o.length=n.length}},d(e){S(o,e),e&&$(t)}}}function me(e){let t,n,o,i,r,f,h,p=e[5].name+"",v=e[5].website+"";function g(){return e[3](e[5])}return{c(){t=s("li"),n=l(p),o=l(" ("),i=l(v),r=l(")\n        "),c(t,"class","ovo-li ovo-ptr")},m(e,s){a(e,t,s),u(t,n),u(t,o),u(t,i),u(t,r),f||(h=d(t,"click",g),f=!0)},p(t,o){e=t,1&o&&p!==(p=e[5].name+"")&&m(n,p),1&o&&v!==(v=e[5].website+"")&&m(i,v)},d(e){e&&$(t),f=!1,h()}}}function fe(e){let t;function n(e,t){return e[0].length?de:ue}let o=n(e),l=o(e);return{c(){t=s("ul"),l.c(),c(t,"class","ovo-ul svelte-zxn7hw")},m(e,n){a(e,t,n),l.m(t,null)},p(e,s){o===(o=n(e))&&l?l.p(e,s):(l.d(1),l=o(e),l&&(l.c(),l.m(t,null)))},d(e){e&&$(t),l.d()}}}function he(e){let t,n;return t=new K({props:{title:"@",$$slots:{default:[fe]},$$scope:{ctx:e}}}),{c(){b(t.$$.fragment)},m(e,o){k(t,e,o),n=!0},p(e,[n]){const o={};257&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(v(t.$$.fragment,e),n=!0)},o(e){g(t.$$.fragment,e),n=!1},d(e){x(t,e)}}}function pe(e,t,n){let o;C(e,re,(e=>n(2,o=e)));let s=[];const l=j();function i(e){l("change",e)}return e.$$.update=()=>{5&e.$$.dirty&&o&&(n(0,s=[]),o.forEach((e=>s.push(e))))},[s,i,o,e=>i(e)]}class ve extends e{constructor(e){super(),t(this,e,pe,he,n,{})}}const ge=/[a-zA-Z0-9_\u0392-\u03c9\u00c0-\u00ff\u0600-\u06ff\u0400-\u04ff]+|[\u4e00-\u9fff\u3400-\u4dbf\uf900-\ufaff\u3040-\u309f\uac00-\ud7af]+/g;let $e;function we(e){return T(e)}re.subscribe((e=>$e=e)),T.use({renderer:{paragraph:e=>{let t=!1,n=e;return n=n.replace(/@([\u4e00-\u9fa5]|\w)+ /g,(e=>{t=!0;const n=$e.get(e.slice(1).trim());return`<a href="${(null==n?void 0:n.website)||""}">${e}</a> `})),n=n.replace(/#(\d+|[a-z,0-9]{7}) /g,(e=>(t=!0,`<a href="#ovo-${e.slice(1).trim()}">${e}</a>`))),!!t&&"<p>"+n+"</p>"}}});class ye{static init(e){this.server=e.server,this.timeout=e.timeout}static async postComment(e){const t=new Blob([JSON.stringify(e)],{type:"application/json"}),n=await be(`${this.server}/comment`,{method:"POST",timeout:this.timeout,body:t});try{if(!n.ok)throw new Error("error posting comment "+e);const t=await n.json();if(null==t?void 0:t.errmsg)throw new Error(t.errmsg)}catch(o){throw o}}static async postReply(e){const t=new Blob([JSON.stringify(e)],{type:"application/json"}),n=await be(`${this.server}/reply`,{method:"POST",timeout:this.timeout,body:t});try{if(!n.ok)throw new Error("error posting comment "+e);const t=await n.json();if(null==t?void 0:t.errmsg)throw new Error(t.errmsg)}catch(o){throw o}}static async getComments(e){const t=new URLSearchParams;t.set("domain",encodeURIComponent(e.domain)),t.set("path",encodeURIComponent(e.path)),t.set("page",encodeURIComponent(e.page));const n=await be(`${this.server}/comment?${t.toString()}`,{timeout:this.timeout});try{if(!n.ok)throw new Error("error getting comments "+e);const t=await n.json();if(null==t?void 0:t.errmsg)throw new Error(t.errmsg);return t}catch(o){throw o}}}async function be(e,t){let n=null;n=setTimeout((()=>{throw n&&(clearTimeout(n),n=null),new Error("timeout")}),t.timeout);const o=await fetch(e,t);return clearTimeout(n),n=null,o}class ke{static init(){this.store=new Map}static on(e,t){this.store||this.init(),this.store.has(e)||this.store.set(e,new Set),this.store.get(e).add(t)}static off(e,t){if(!this.store)throw new Error("nothing to remove");this.store.get(e).delete(t)}static emit(e,...t){if(!this.store)throw new Error("nothing to emit");const n=this.store.get(e);n&&n.forEach((function(e){e(...t)}))}}function xe(e){let t,n,o,f,h,p,y,j,O,E,S,M,C,L,T,z,D,H,R,I,P,q,A,B,J,U,W,Y,F,G,K,Q,Z,V,X,ee,te,ne,oe=e[4].editor.preview+"",se=e[9]?`${e[4].editor.waiting}`:`${e[4].editor.submit}`;return D=new ie({props:{emoji:e[5],locale:e[4]}}),D.$on("change",e[13]),R=new ve({}),R.$on("change",e[14]),{c(){t=s("form"),n=s("div"),o=s("input"),h=i(),p=s("input"),j=i(),O=s("input"),S=i(),M=s("textarea"),C=i(),L=s("div"),T=i(),z=s("div"),b(D.$$.fragment),H=i(),b(R.$$.fragment),I=i(),P=s("div"),q=l(oe),A=i(),B=s("div"),J=l(e[10]),U=i(),W=s("div"),Y=i(),F=s("div"),G=l(e[12]),K=l("/"),Q=l(je),Z=i(),V=s("button"),X=l(se),c(o,"type","text"),c(o,"placeholder",f=e[4].editor.name),o.required=!0,c(o,"class","svelte-1o8ler7"),c(p,"type","email"),c(p,"placeholder",y=e[4].editor.email),p.required=!0,c(p,"class","svelte-1o8ler7"),c(O,"type","url"),c(O,"placeholder",E=e[4].editor.website),O.required=!0,c(O,"class","svelte-1o8ler7"),c(n,"class","info svelte-1o8ler7"),c(M,"placeholder",e[0]),M.required=!0,c(M,"class","svelte-1o8ler7"),c(L,"class","preview svelte-1o8ler7"),r(L,"open",e[7]),c(P,"class","ovo-btn"),c(P,"data-active",e[7]),c(B,"class","ovo-oa-x"),c(V,"class","ovo-btn"),c(V,"type","submit"),c(V,"data-disabled",e[9]),c(z,"class","action svelte-1o8ler7"),c(t,"class","svelte-1o8ler7")},m(s,l){a(s,t,l),u(t,n),u(n,o),N(o,e[1]),u(n,h),u(n,p),N(p,e[2]),u(n,j),u(n,O),N(O,e[3]),u(t,S),u(t,M),e[20](M),N(M,e[8]),u(t,C),u(t,L),L.innerHTML=e[11],u(t,T),u(t,z),k(D,z,null),u(z,H),k(R,z,null),u(z,I),u(z,P),u(P,q),u(z,A),u(z,B),u(B,J),u(z,U),u(z,W),u(z,Y),u(z,F),u(F,G),u(F,K),u(F,Q),u(z,Z),u(z,V),u(V,X),ee=!0,te||(ne=[d(o,"input",e[17]),d(p,"input",e[18]),d(O,"input",e[19]),d(M,"input",e[21]),d(P,"click",e[22]),d(t,"submit",_(e[15]))],te=!0)},p(e,[t]){(!ee||16&t&&f!==(f=e[4].editor.name))&&c(o,"placeholder",f),2&t&&o.value!==e[1]&&N(o,e[1]),(!ee||16&t&&y!==(y=e[4].editor.email))&&c(p,"placeholder",y),4&t&&p.value!==e[2]&&N(p,e[2]),(!ee||16&t&&E!==(E=e[4].editor.website))&&c(O,"placeholder",E),8&t&&N(O,e[3]),(!ee||1&t)&&c(M,"placeholder",e[0]),256&t&&N(M,e[8]),(!ee||2048&t)&&(L.innerHTML=e[11]),128&t&&r(L,"open",e[7]);const n={};32&t&&(n.emoji=e[5]),16&t&&(n.locale=e[4]),D.$set(n),(!ee||16&t)&&oe!==(oe=e[4].editor.preview+"")&&m(q,oe),(!ee||128&t)&&c(P,"data-active",e[7]),(!ee||1024&t)&&m(J,e[10]),(!ee||4096&t)&&m(G,e[12]),(!ee||528&t)&&se!==(se=e[9]?`${e[4].editor.waiting}`:`${e[4].editor.submit}`)&&m(X,se),(!ee||512&t)&&c(V,"data-disabled",e[9])},i(e){ee||(v(D.$$.fragment,e),v(R.$$.fragment,e),ee=!0)},o(e){g(D.$$.fragment,e),g(R.$$.fragment,e),ee=!1},d(n){n&&$(t),e[20](null),x(D),x(R),te=!1,w(ne)}}}const je=400;function Oe(e,t,n){let o,s;C(e,ce,(e=>n(16,s=e)));var l=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(s,l){function i(e){try{r(o.next(e))}catch(t){l(t)}}function c(e){try{r(o.throw(e))}catch(t){l(t)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}r((o=o.apply(e,t||[])).next())}))};let i,{locale:c}=t,{placeholder:r=c.editor.placeholder}=t,{emoji:a=""}=t,u=!1,d=!1,m="",f="",h="",{name:p="",email:v="",website:g=""}=t;function $(e){const t=i.selectionStart,o=i.selectionEnd;n(8,f=f.substring(0,t)+e+f.substring(o,f.length)),n(6,i.selectionStart=t+a.length,i),n(6,i.selectionEnd=t+a.length,i),i.focus()}ke.on("refresh",(function(){ce.update((()=>null)),n(0,r=c.editor.placeholder),n(8,f=""),n(10,m=""),n(7,u=!1)})),ke.on("ref",(function(e){$(`#${e} `)}));return e.$$set=e=>{"locale"in e&&n(4,c=e.locale),"placeholder"in e&&n(0,r=e.placeholder),"emoji"in e&&n(5,a=e.emoji),"name"in e&&n(1,p=e.name),"email"in e&&n(2,v=e.email),"website"in e&&n(3,g=e.website)},e.$$.update=()=>{256&e.$$.dirty&&n(12,o=function(e){const t=e.match(ge);let n=0;if(!t)return 0;for(let o=0;o<t.length;o++)t[o].charCodeAt(0)>=19968?n+=t[o].length:n+=1;return n}(f)),384&e.$$.dirty&&u&&n(11,h=we(f)),65617&e.$$.dirty&&s&&(n(0,r=`${c.comment.reply}#${s.id}`),n(10,m=r),i&&i.focus())},[r,p,v,g,c,a,i,u,f,d,m,h,o,function(e){$(e.detail.text)},function(e){const t=`@${e.detail.name} `;console.log(e.detail),$(t)},function(){return l(this,void 0,void 0,(function*(){if(d)return;let e;if(n(9,d=!0),n(11,h=h||we(f)),s){const{cid:t,id:n}=s;e={cid:t||n,rid:t?n:null}}const t={name:p,email:v,website:g},o=Object.assign({domain:location.hostname,path:location.pathname,content:h,user:t},e);localStorage.user=JSON.stringify(t);try{s?yield ye.postReply(o):yield ye.postComment(o)}catch(l){return void alert(l.message)}finally{n(9,d=!1)}alert(c.editor.success),ke.emit("refresh")}))},s,function(){p=this.value,n(1,p)},function(){v=this.value,n(2,v)},function(){g=this.value,n(3,g)},function(e){z[e?"unshift":"push"]((()=>{i=e,n(6,i)}))},function(){f=this.value,n(8,f)},()=>n(7,u=!u)]}class Ee extends e{constructor(e){super(),t(this,e,Oe,xe,n,{locale:4,placeholder:0,emoji:5,name:1,email:2,website:3})}}function Se(e,t){if(e)for(let n=0;n<e.length;n++)t(e[n]),Se(e[n].children,t)}function Me(e){let t,n,o=e[1]?`${e[0].sentinal.eol}`:`${e[0].sentinal.loading}`;return{c(){t=s("div"),n=l(o),c(t,"class","ovo-s svelte-1l5g19d")},m(o,s){a(o,t,s),u(t,n),e[3](t)},p(e,[t]){3&t&&o!==(o=e[1]?`${e[0].sentinal.eol}`:`${e[0].sentinal.loading}`)&&m(n,o)},i:y,o:y,d(n){n&&$(t),e[3](null)}}}function Ce(e,t,n){let o,{locale:s}=t,{done:l=!1}=t;const i=j(),c=new IntersectionObserver((function(e){e[0].intersectionRatio<=.8||i("visiable",e[0])}),{threshold:[.8]});return D((function(){c.observe(o)})),H((function(){c.disconnect()})),e.$$set=e=>{"locale"in e&&n(0,s=e.locale),"done"in e&&n(1,l=e.done)},[s,l,o,function(e){z[e?"unshift":"push"]((()=>{o=e,n(2,o)}))}]}class Le extends e{constructor(e){super(),t(this,e,Ce,Me,n,{locale:0,done:1})}}function Te(e,t=!1){const n=new Date(e),o=(new Date).getTime()-n.getTime();if(o<6e4)return`${Math.ceil(o/1e3)} 秒前`;if(o<36e5)return`${Math.ceil(o/6e4)} 分钟前`;if(o<864e5)return`${Math.ceil(o/36e5)} 小时前`;let s=`${n.getFullYear()}-${n.getMonth()+1}-${n.getDate()}`;return t&&(s+=` ${n.getHours()}:${n.getMinutes()}:${n.getSeconds()}`),s}function Ne(e,t,n){const o=e.slice();return o[10]=t[n],o[12]=n,o}function _e(e){let t,n,o=e[0],s=[];for(let i=0;i<o.length;i+=1)s[i]=ze(Ne(e,o,i));const l=e=>g(s[e],1,1,(()=>{s[e]=null}));return{c(){for(let e=0;e<s.length;e+=1)s[e].c();t=L()},m(e,o){for(let t=0;t<s.length;t+=1)s[t].m(e,o);a(e,t,o),n=!0},p(e,n){if(111&n){let i;for(o=e[0],i=0;i<o.length;i+=1){const l=Ne(e,o,i);s[i]?(s[i].p(l,n),v(s[i],1)):(s[i]=ze(l),s[i].c(),v(s[i],1),s[i].m(t.parentNode,t))}for(R(),i=o.length;i<s.length;i+=1)l(i);I()}},i(e){if(!n){for(let e=0;e<o.length;e+=1)v(s[e]);n=!0}},o(e){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)g(s[t]);n=!1},d(e){S(s,e),e&&$(t)}}}function ze(e){var t,n;let o,f,h,p,y,j,O,E,S,M,C,L,T,N,_,z,D,H,R,I,P,q,A,B,J,U,W,Y,F,G,K,Q,Z=(null==(t=e[10].user)?void 0:t.name)+"",V=e[10].id+"",X=Te(e[10].ctime)+"",ee=((null==(n=e[10].children)?void 0:n.length)||0)+"",te=e[1].comment.comment+"",ne=e[1].comment.reply+"",oe=e[10].content+"";function se(){return e[7](e[10])}function le(){return e[8](e[12])}function ie(){return e[9](e[10])}return W=new Re({props:{comments:e[10].children,locale:e[1]}}),{c(){var t;o=s("article"),f=s("div"),h=s("span"),p=s("a"),y=l(Z),O=i(),E=s("span"),S=l("#"),M=l(V),L=i(),T=s("span"),N=l(X),_=i(),z=s("span"),D=l(ee),H=i(),R=l(te),I=i(),P=s("span"),q=l(ne),A=i(),B=s("div"),J=i(),U=s("div"),b(W.$$.fragment),Y=i(),c(p,"href",j=null==(t=e[10].user)?void 0:t.website),c(p,"target","_blank"),c(p,"class","svelte-inkkd3"),c(h,"class","ovo-b"),c(E,"class","ovo-s ovo-ptr"),c(E,"title",C=e[1].comment.reference),c(T,"class","ovo-s"),c(z,"class","ovo-s ovo-a ovo-ptr"),c(P,"class","ovo-s ovo-r ovo-ptr"),c(f,"class","info svelte-inkkd3"),c(B,"class","content svelte-inkkd3"),c(U,"class","details svelte-inkkd3"),r(U,"open",e[3]&1<<e[12]+1),c(o,"id",F="ovo-"+e[10].id),c(o,"class","svelte-inkkd3"),r(o,"active",e[2]&&e[2].slice(5)===e[10].id)},m(e,t){a(e,o,t),u(o,f),u(f,h),u(h,p),u(p,y),u(f,O),u(f,E),u(E,S),u(E,M),u(f,L),u(f,T),u(T,N),u(f,_),u(f,z),u(z,D),u(z,H),u(z,R),u(f,I),u(f,P),u(P,q),u(o,A),u(o,B),B.innerHTML=oe,u(o,J),u(o,U),k(W,U,null),u(o,Y),G=!0,K||(Q=[d(E,"click",se),d(z,"click",le),d(P,"click",ie)],K=!0)},p(t,n){var s,l,i;e=t,(!G||1&n)&&Z!==(Z=(null==(s=e[10].user)?void 0:s.name)+"")&&m(y,Z),(!G||1&n&&j!==(j=null==(l=e[10].user)?void 0:l.website))&&c(p,"href",j),(!G||1&n)&&V!==(V=e[10].id+"")&&m(M,V),(!G||2&n&&C!==(C=e[1].comment.reference))&&c(E,"title",C),(!G||1&n)&&X!==(X=Te(e[10].ctime)+"")&&m(N,X),(!G||1&n)&&ee!==(ee=((null==(i=e[10].children)?void 0:i.length)||0)+"")&&m(D,ee),(!G||2&n)&&te!==(te=e[1].comment.comment+"")&&m(R,te),(!G||2&n)&&ne!==(ne=e[1].comment.reply+"")&&m(q,ne),(!G||1&n)&&oe!==(oe=e[10].content+"")&&(B.innerHTML=oe);const a={};1&n&&(a.comments=e[10].children),2&n&&(a.locale=e[1]),W.$set(a),8&n&&r(U,"open",e[3]&1<<e[12]+1),(!G||1&n&&F!==(F="ovo-"+e[10].id))&&c(o,"id",F),5&n&&r(o,"active",e[2]&&e[2].slice(5)===e[10].id)},i(e){G||(v(W.$$.fragment,e),G=!0)},o(e){g(W.$$.fragment,e),G=!1},d(e){e&&$(o),x(W),K=!1,w(Q)}}}function De(e){let t,n,o,s,l=e[0]&&_e(e);return{c(){l&&l.c(),t=L()},m(i,c){l&&l.m(i,c),a(i,t,c),n=!0,o||(s=d(window,"hashchange",e[4]),o=!0)},p(e,[n]){e[0]?l?(l.p(e,n),1&n&&v(l,1)):(l=_e(e),l.c(),v(l,1),l.m(t.parentNode,t)):l&&(R(),g(l,1,1,(()=>{l=null})),I())},i(e){n||(v(l),n=!0)},o(e){g(l),n=!1},d(e){l&&l.d(e),e&&$(t),o=!1,s()}}}function He(e,t,n){let{comments:o=[]}=t,{locale:s}=t,l=location.hash;function i(e){ce.set(e)}let c=0;function r(e){n(3,c^=1<<e)}return e.$$set=e=>{"comments"in e&&n(0,o=e.comments),"locale"in e&&n(1,s=e.locale)},[o,s,l,c,function(){const e=location.hash;n(2,l=/#ovo-(\d+|[a-z,0-9]{7})/.test(e)?e:"")},i,r,e=>ke.emit("ref",e.id),e=>r(e+1),e=>i(e)]}class Re extends e{constructor(e){super(),t(this,e,He,De,n,{comments:0,locale:1})}}var Ie={locale:"zh-Hans",editor:{name:"昵称",email:"邮箱",website:"网址",faces:"OvO",preview:"预览",submit:"发布",waiting:"发布中",words:"字",placeholder:"说点什么吧～",success:"发布成功 φ(￣∇￣o)"},comment:{title:"评论",comment:"条评论",reply:"回复",reference:"引用"},sentinal:{loading:"加载中",eol:"到底啦 OvO"}};function Pe(e){let t,n,o,r,d,f,h,p=e[0].comment.title+"";return f=new Re({props:{comments:e[5],locale:e[0]}}),{c(){t=s("h3"),n=l(p),o=i(),r=l(e[4]),d=i(),b(f.$$.fragment),c(t,"class","svelte-2zuo7e")},m(e,s){a(e,t,s),u(t,n),u(t,o),u(t,r),a(e,d,s),k(f,e,s),h=!0},p(e,t){(!h||1&t)&&p!==(p=e[0].comment.title+"")&&m(n,p),(!h||16&t)&&m(r,e[4]);const o={};32&t&&(o.comments=e[5]),1&t&&(o.locale=e[0]),f.$set(o)},i(e){h||(v(f.$$.fragment,e),h=!0)},o(e){g(f.$$.fragment,e),h=!1},d(e){e&&$(t),e&&$(d),x(f,e)}}}function qe(e){let t,n,o,l,r,d;const m=[{placeholder:e[1]},{emoji:e[2]},{locale:e[0]},e[6]];let f={};for(let s=0;s<m.length;s+=1)f=P(f,m[s]);n=new Ee({props:f});let h=e[5]&&Pe(e);return r=new Le({props:{done:e[3],locale:e[0]}}),r.$on("visiable",e[7]),{c(){t=s("section"),b(n.$$.fragment),o=i(),h&&h.c(),l=i(),b(r.$$.fragment),c(t,"class","OvO svelte-2zuo7e")},m(e,s){a(e,t,s),k(n,t,null),u(t,o),h&&h.m(t,null),u(t,l),k(r,t,null),d=!0},p(e,[o]){const s=71&o?q(m,[2&o&&{placeholder:e[1]},4&o&&{emoji:e[2]},1&o&&{locale:e[0]},64&o&&A(e[6])]):{};n.$set(s),e[5]?h?(h.p(e,o),32&o&&v(h,1)):(h=Pe(e),h.c(),v(h,1),h.m(t,l)):h&&(R(),g(h,1,1,(()=>{h=null})),I());const i={};8&o&&(i.done=e[3]),1&o&&(i.locale=e[0]),r.$set(i)},i(e){d||(v(n.$$.fragment,e),v(h),v(r.$$.fragment,e),d=!0)},o(e){g(n.$$.fragment,e),g(h),g(r.$$.fragment,e),d=!1},d(e){e&&$(t),x(n),h&&h.d(),x(r)}}}function Ae(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(s,l){function i(e){try{r(o.next(e))}catch(t){l(t)}}function c(e){try{r(o.throw(e))}catch(t){l(t)}}function r(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}r((o=o.apply(e,t||[])).next())}))};let{locale:s=Ie}=t,{placeholder:l=s.editor.placeholder}=t,{emoji:i="https://cdn.jsdelivr.net/gh/DejavuMoe/DejavuMoe/emoji.json"}=t,{server:c="https://www.fastmock.site/mock/112f2e694fa5334c4d698ce22a512405/ovo"}=t,{timeout:r=1e4}=t;ye.init({server:c,timeout:r});const a=new Map;let u,d,m,f,h,p;function v(){n(5,f=null),n(5,f=[]),d=-1,n(4,m=0),n(3,u=!1),a.clear()}return v(),D((function(){const e=localStorage.user;e&&n(6,p=JSON.parse(e))})),H((function(){console.log("OvO was destroyed")})),ke.on("refresh",v),e.$$set=e=>{"locale"in e&&n(0,s=e.locale),"placeholder"in e&&n(1,l=e.placeholder),"emoji"in e&&n(2,i=e.emoji),"server"in e&&n(8,c=e.server),"timeout"in e&&n(9,r=e.timeout)},[s,l,i,u,m,f,p,function(e){return o(this,void 0,void 0,(function*(){if(!u){d++;try{h=yield ye.getComments({domain:location.hostname,path:location.pathname,page:d})}catch(e){throw d--,n(3,u=!0),e}n(3,u=h.done),n(5,f=[...f,...h.comments]),n(4,m=0),a.clear(),Se(f,(function({user:e}){n(4,m++,m),e&&a.set(e.name,e)})),re.set(a)}}))},c,r]}class Be extends e{constructor(e){super(),t(this,e,Ae,qe,n,{locale:0,placeholder:1,emoji:2,server:8,timeout:9})}}function Je(e){let t,n,o;return{c(){t=s("input"),c(t,"type","checkbox"),c(t,"class","svelte-19wt9bf")},m(s,l){a(s,t,l),t.checked=e[0],n||(o=d(t,"change",e[1]),n=!0)},p(e,[n]){1&n&&(t.checked=e[0])},i:y,o:y,d(e){e&&$(t),n=!1,o()}}}function Ue(e,t,n){let{checked:o=!1}=t;return e.$$set=e=>{"checked"in e&&n(0,o=e.checked)},[o,function(){o=this.checked,n(0,o)}]}class We extends e{constructor(e){super(),t(this,e,Ue,Je,n,{checked:0})}}var Ye={"简体中文":{locale:"zh-Hans",editor:{name:"昵称",email:"邮箱",website:"网址",faces:"OvO",preview:"预览",submit:"发布",waiting:"发布中",words:"字",placeholder:"说点什么吧～",success:"发布成功 φ(￣∇￣o)"},comment:{title:"评论",comment:"条评论",reply:"回复",reference:"引用"},sentinal:{loading:"加载中",eol:"到底啦 OvO"}},English:{locale:"en",editor:{name:"Nickname",email:"Email",website:"Website",faces:"OvO",preview:"Preview",submit:"Submit",waiting:"Waiting",words:"Words",placeholder:"Leave your comments",success:"Success φ(￣∇￣o)"},comment:{title:"Total",comment:"comments",reply:"reply",reference:"reference"},sentinal:{loading:"Loading comments",eol:"You've reached the End OvO"}}};function Fe(e,t,n){const o=e.slice();return o[6]=t[n],o}function Ge(e){let t,n,o,i=e[6]+"";return{c(){t=s("option"),n=l(i),t.__value=o=e[6],t.value=t.__value},m(e,o){a(e,t,o),u(t,n)},p:y,d(e){e&&$(t)}}}function Ke(e){let t,n,o,r,f,h,p,w,y,j,O,E,M,C,L,T,N,_,D,H,R,I,P,q,A=e[0]?"🌑":"🌞";function Y(t){e[4](t)}let F={};void 0!==e[0]&&(F.checked=e[0]),M=new We({props:F}),z.push((()=>B(M,"checked",Y)));let G=Object.keys(Ye),K=[];for(let s=0;s<G.length;s+=1)K[s]=Ge(Fe(e,G,s));return R=new Be({props:{locale:e[2]}}),{c(){t=s("main"),n=s("h1"),n.textContent="OvO",o=i(),r=s("h2"),r.textContent="A Svelte Web Component for Comments",f=i(),h=s("p"),h.innerHTML='Inspired by <a href="https://github.com/DIYgod/OwO" class="svelte-9s02sx">OωO</a>. Available on\n    <a href="https://github.com/ovojs/OvO" class="svelte-9s02sx">GitHub</a>. Docs in\n    <a href="https://github.com/ovojs/OvO/blob/main/README.md" class="svelte-9s02sx">README</a>',p=i(),w=s("div"),y=s("div"),j=s("span"),O=l(A),E=i(),b(M.$$.fragment),L=i(),T=s("div"),N=s("span"),_=i(),D=s("select");for(let e=0;e<K.length;e+=1)K[e].c();H=i(),b(R.$$.fragment),c(n,"class","svelte-9s02sx"),c(h,"class","svelte-9s02sx"),c(y,"class","svelte-9s02sx"),c(D,"class","svelte-9s02sx"),void 0===e[1]&&J((()=>e[5].call(D))),c(T,"class","svelte-9s02sx"),c(w,"class","svelte-9s02sx"),c(t,"class","svelte-9s02sx")},m(s,l){a(s,t,l),u(t,n),u(t,o),u(t,r),u(t,f),u(t,h),u(t,p),u(t,w),u(w,y),u(y,j),u(j,O),u(y,E),k(M,y,null),u(w,L),u(w,T),u(T,N),u(T,_),u(T,D);for(let e=0;e<K.length;e+=1)K[e].m(D,null);U(D,e[1]),u(t,H),k(R,t,null),I=!0,P||(q=d(D,"change",e[5]),P=!0)},p(e,[t]){(!I||1&t)&&A!==(A=e[0]?"🌑":"🌞")&&m(O,A);const n={};if(!C&&1&t&&(C=!0,n.checked=e[0],W((()=>C=!1))),M.$set(n),0&t){let n;for(G=Object.keys(Ye),n=0;n<G.length;n+=1){const o=Fe(e,G,n);K[n]?K[n].p(o,t):(K[n]=Ge(o),K[n].c(),K[n].m(D,null))}for(;n<K.length;n+=1)K[n].d(1);K.length=G.length}2&t&&U(D,e[1]);const o={};4&t&&(o.locale=e[2]),R.$set(o)},i(e){I||(v(M.$$.fragment,e),v(R.$$.fragment,e),I=!0)},o(e){g(M.$$.fragment,e),g(R.$$.fragment,e),I=!1},d(e){e&&$(t),x(M),S(K,e),x(R),P=!1,q()}}}function Qe(e,t,n){let o,s=!1,l="light",i="简体中文";try{l=localStorage.theme,s="dark"===l}catch(c){}return e.$$.update=()=>{if(2&e.$$.dirty&&n(2,o=Ye[i]),9&e.$$.dirty){const{classList:e}=document.querySelector("html");e.remove(l),n(3,l=s?"dark":"light"),e.add(l);try{localStorage.theme=l}catch(c){}}},[s,i,o,l,function(e){s=e,n(0,s)},function(){i=Y(this),n(1,i)}]}new class extends e{constructor(e){super(),t(this,e,Qe,Ke,n,{})}}({target:document.getElementById("app")});
