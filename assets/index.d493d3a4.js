var e=Object.defineProperty,t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(t,n,o)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o;import{S as i,i as r,s as l,c,e as a,t as u,a as d,b as m,d as f,f as h,g as p,l as v,h as g,u as $,j as w,k as b,m as y,n as k,o as x,r as O,p as j,q as _,v as E,w as S,x as C,y as M,z as L,A as T,B as I,C as R,D as N,E as P,F as z,G as D,H,I as A,J as q,K as U,L as B,M as J,N as W,O as Y,P as F,Q as G,R as K,T as Q,U as Z}from"./vendor.c649066a.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();function V(e){let t,n,o,s,i,r,l,j;const _=e[3].default,E=c(_,e,e[2],null);return{c(){t=a("div"),n=a("div"),o=u(e[1]),s=d(),i=a("div"),E&&E.c(),m(n,"class","ovo-btn"),m(n,"data-active",e[0]),m(i,"class","details ovo-bg ovo-bdr svelte-ikycck"),f(i,"open",e[0]),m(t,"class","drop svelte-ikycck"),m(t,"tabindex","0")},m(c,a){h(c,t,a),p(t,n),p(n,o),p(t,s),p(t,i),E&&E.m(i,null),r=!0,l||(j=[v(n,"click",e[4]),v(t,"blur",e[5])],l=!0)},p(e,[t]){(!r||2&t)&&g(o,e[1]),(!r||1&t)&&m(n,"data-active",e[0]),E&&E.p&&(!r||4&t)&&$(E,_,e,e[2],r?b(_,e[2],t,null):w(e[2]),null),1&t&&f(i,"open",e[0])},i(e){r||(y(E,e),r=!0)},o(e){k(E,e),r=!1},d(e){e&&x(t),E&&E.d(e),l=!1,O(j)}}}function X(e,t,n){let{$$slots:o={},$$scope:s}=t,{title:i=""}=t,{open:r=!1}=t;return e.$$set=e=>{"title"in e&&n(1,i=e.title),"open"in e&&n(0,r=e.open),"$$scope"in e&&n(2,s=e.$$scope)},[r,i,s,o,()=>n(0,r=!r),()=>n(0,r=!1)]}class ee extends i{constructor(e){super(),r(this,e,X,V,l,{title:1,open:0})}}function te(e){let t;return{c(){t=a("div"),t.textContent="加载中",m(t,"class","svelte-q18c5f")},m(e,n){h(e,t,n)},p:j,i:j,o:j,d(e){e&&x(t)}}}class ne extends i{constructor(e){super(),r(this,e,null,te,l,{})}}function oe(e,t,n){const o=e.slice();return o[9]=t[n],o}function se(e){return{c:j,m:j,p:j,i:j,o:j,d:j}}function ie(e){let t,n=e[8].temoji,o=[];for(let s=0;s<n.length;s+=1)o[s]=re(oe(e,n,s));return{c(){t=a("ul");for(let e=0;e<o.length;e+=1)o[e].c();m(t,"class","ovo-ul svelte-1b0ew32")},m(e,n){h(e,t,n);for(let s=0;s<o.length;s+=1)o[s].m(t,null)},p(e,s){if(6&s){let i;for(n=e[8].temoji,i=0;i<n.length;i+=1){const r=oe(e,n,i);o[i]?o[i].p(r,s):(o[i]=re(r),o[i].c(),o[i].m(t,null))}for(;i<o.length;i+=1)o[i].d(1);o.length=n.length}},i:j,o:j,d(e){e&&x(t),T(o,e)}}}function re(e){let t,n,o,s,i,r=e[9].text+"";function l(){return e[4](e[9])}return{c(){t=a("li"),n=u(r),m(t,"title",o=e[9].title),m(t,"class","svelte-1b0ew32")},m(e,o){h(e,t,o),p(t,n),s||(i=v(t,"click",l),s=!0)},p(t,n){e=t},d(e){e&&x(t),s=!1,i()}}}function le(e){let t,n;return t=new ne({}),{c(){_(t.$$.fragment)},m(e,o){E(t,e,o),n=!0},p:j,i(e){n||(y(t.$$.fragment,e),n=!0)},o(e){k(t.$$.fragment,e),n=!1},d(e){S(t,e)}}}function ce(e){let t,n,o={ctx:e,current:null,token:null,hasCatch:!1,pending:le,then:ie,catch:se,value:8,blocks:[,,,]};return M(e[2],o),{c(){t=a("div"),o.block.c(),m(t,"class","emoji svelte-1b0ew32")},m(e,s){h(e,t,s),o.block.m(t,o.anchor=null),o.mount=()=>t,o.anchor=null,n=!0},p(t,n){L(o,e=t,n)},i(e){n||(y(o.block),n=!0)},o(e){for(let t=0;t<3;t+=1){const e=o.blocks[t];k(e)}n=!1},d(e){e&&x(t),o.block.d(),o.token=null,o=null}}}function ae(e){let t,n;return t=new ee({props:{title:e[0].editor.faces,$$slots:{default:[ce]},$$scope:{ctx:e}}}),{c(){_(t.$$.fragment)},m(e,o){E(t,e,o),n=!0},p(e,[n]){const o={};1&n&&(o.title=e[0].editor.faces),4096&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(y(t.$$.fragment,e),n=!0)},o(e){k(t.$$.fragment,e),n=!1},d(e){S(t,e)}}}function ue(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(s,i){function r(e){try{c(o.next(e))}catch(t){i(t)}}function l(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,l)}c((o=o.apply(e,t||[])).next())}))};let{emoji:s=""}=t,{locale:i}=t;const r=C();function l(e){r("change",e)}const c=function(e){return o(this,void 0,void 0,(function*(){if(!e)throw new Error("no emoji source provided");const t=yield fetch(e);try{if(t.ok){return yield t.json()}}catch(n){throw n}}))}(s);return e.$$set=e=>{"emoji"in e&&n(3,s=e.emoji),"locale"in e&&n(0,i=e.locale)},[i,l,c,s,e=>l(e)]}class de extends i{constructor(e){super(),r(this,e,ue,ae,l,{emoji:3,locale:0})}}const me=I(null),fe=I(null);function he(e,t,n){const o=e.slice();return o[5]=t[n],o}function pe(e){let t;return{c(){t=a("div"),t.textContent="没有可以 @ 的人呢",m(t,"class","svelte-zxn7hw")},m(e,n){h(e,t,n)},p:j,d(e){e&&x(t)}}}function ve(e){let t,n=e[0],o=[];for(let s=0;s<n.length;s+=1)o[s]=ge(he(e,n,s));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=N()},m(e,n){for(let t=0;t<o.length;t+=1)o[t].m(e,n);h(e,t,n)},p(e,s){if(3&s){let i;for(n=e[0],i=0;i<n.length;i+=1){const r=he(e,n,i);o[i]?o[i].p(r,s):(o[i]=ge(r),o[i].c(),o[i].m(t.parentNode,t))}for(;i<o.length;i+=1)o[i].d(1);o.length=n.length}},d(e){T(o,e),e&&x(t)}}}function ge(e){let t,n,o,s,i,r,l,c=e[5].issuer+"",d=e[5].issuer_website+"";function f(){return e[3](e[5])}return{c(){t=a("li"),n=u(c),o=u(" ("),s=u(d),i=u(")\n        "),m(t,"class","ovo-li ovo-ptr")},m(e,c){h(e,t,c),p(t,n),p(t,o),p(t,s),p(t,i),r||(l=v(t,"click",f),r=!0)},p(t,o){e=t,1&o&&c!==(c=e[5].issuer+"")&&g(n,c),1&o&&d!==(d=e[5].issuer_website+"")&&g(s,d)},d(e){e&&x(t),r=!1,l()}}}function $e(e){let t;function n(e,t){return e[0].length?ve:pe}let o=n(e),s=o(e);return{c(){t=a("ul"),s.c(),m(t,"class","ovo-ul svelte-zxn7hw")},m(e,n){h(e,t,n),s.m(t,null)},p(e,i){o===(o=n(e))&&s?s.p(e,i):(s.d(1),s=o(e),s&&(s.c(),s.m(t,null)))},d(e){e&&x(t),s.d()}}}function we(e){let t,n;return t=new ee({props:{title:"@",$$slots:{default:[$e]},$$scope:{ctx:e}}}),{c(){_(t.$$.fragment)},m(e,o){E(t,e,o),n=!0},p(e,[n]){const o={};257&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(y(t.$$.fragment,e),n=!0)},o(e){k(t.$$.fragment,e),n=!1},d(e){S(t,e)}}}function be(e,t,n){let o;R(e,fe,(e=>n(2,o=e)));let s=[];const i=C();function r(e){i("change",e)}return e.$$.update=()=>{5&e.$$.dirty&&o&&(n(0,s=[]),o.forEach((e=>s.push(e))))},[s,r,o,e=>r(e)]}class ye extends i{constructor(e){super(),r(this,e,be,we,l,{})}}const ke=/[a-zA-Z0-9_\u0392-\u03c9\u00c0-\u00ff\u0600-\u06ff\u0400-\u04ff]+|[\u4e00-\u9fff\u3400-\u4dbf\uf900-\ufaff\u3040-\u309f\uac00-\ud7af]+/g;let xe;function Oe(e){return P(e)}fe.subscribe((e=>xe=e)),P.use({renderer:{paragraph:e=>{let t=!1,n=e;return n=n.replace(/@([\u4e00-\u9fa5]|\w)+ /g,(e=>{t=!0;const n=xe.get(e.slice(1).trim());return`<a href="${(null==n?void 0:n.issuer_website)||""}">${e}</a> `})),n=n.replace(/#(\d+|[a-z,0-9]{7}) /g,(e=>(t=!0,`<a href="#ovo-${e.slice(1).trim()}">${e}</a>`))),!!t&&"<p>"+n+"</p>"}}});class je{static init(e){this.server=e.server,this.timeout=e.timeout}static async postComment(e){const t=new Blob([JSON.stringify(e)],{type:"application/json"}),n=await _e(`${this.server}/comment`,{method:"POST",timeout:this.timeout,body:t,credentials:"include"});try{if(!n.ok)throw new Error("error posting comment "+e);const t=await n.json();if(null==t?void 0:t.errmsg)throw new Error(t.errmsg)}catch(o){throw o}}static async postReply(e){const t=new Blob([JSON.stringify(e)],{type:"application/json"}),n=await _e(`${this.server}/reply`,{method:"POST",timeout:this.timeout,body:t});try{if(!n.ok)throw new Error("error posting comment "+e);const t=await n.json();if(null==t?void 0:t.errmsg)throw new Error(t.errmsg)}catch(o){throw o}}static async getComments(e){const t=new URLSearchParams;t.set("domain",encodeURIComponent(e.domain)),t.set("path",encodeURIComponent(e.path)),t.set("page",String(e.page));const n=await _e(`${this.server}/comment?${t.toString()}`,{timeout:this.timeout});try{if(!n.ok)throw new Error("error getting comments "+e);const t=await n.json();if(null==t?void 0:t.errmsg)throw new Error(t.errmsg);return t}catch(o){throw o}}}async function _e(e,i){let r=null;const l=new AbortController;r=setTimeout((function(){throw r&&(clearTimeout(r),r=null),new Error("timeout")}),i.timeout);const c=await fetch(e,((e,i)=>{for(var r in i||(i={}))n.call(i,r)&&s(e,r,i[r]);if(t)for(var r of t(i))o.call(i,r)&&s(e,r,i[r]);return e})({signal:l.signal},i));return clearTimeout(r),r=null,c}class Ee{static init(){this.store=new Map}static on(e,t){this.store||this.init(),this.store.has(e)||this.store.set(e,new Set),this.store.get(e).add(t)}static off(e,t){if(!this.store)throw new Error("nothing to remove");this.store.get(e).delete(t)}static emit(e,...t){if(!this.store)throw new Error("nothing to emit");const n=this.store.get(e);n&&n.forEach((function(e){e(...t)}))}}function Se(e){let t,n,o,s,i,r,l,c,$,w,b,j,C,M,L,T,I,R,N,P,H,A,q,U,B,J,W,Y,F,G,K,Q,Z,V,X,ee,te,ne,oe=e[4].editor.preview+"",se=e[9]?`${e[4].editor.waiting}`:`${e[4].editor.submit}`;return I=new de({props:{emoji:e[5],locale:e[4]}}),I.$on("change",e[13]),N=new ye({}),N.$on("change",e[14]),{c(){t=a("form"),n=a("div"),o=a("input"),i=d(),r=a("input"),c=d(),$=a("input"),b=d(),j=a("textarea"),C=d(),M=a("div"),L=d(),T=a("div"),_(I.$$.fragment),R=d(),_(N.$$.fragment),P=d(),H=a("div"),A=u(oe),q=d(),U=a("div"),B=u(e[10]),J=d(),W=a("div"),Y=d(),F=a("div"),G=u(e[12]),K=u("/"),Q=u(Ce),Z=d(),V=a("button"),X=u(se),m(o,"type","text"),m(o,"placeholder",s=e[4].editor.name),o.required=!0,m(o,"class","svelte-1o8ler7"),m(r,"type","email"),m(r,"placeholder",l=e[4].editor.email),r.required=!0,m(r,"class","svelte-1o8ler7"),m($,"type","url"),m($,"placeholder",w=e[4].editor.website),$.required=!0,m($,"class","svelte-1o8ler7"),m(n,"class","info svelte-1o8ler7"),m(j,"placeholder",e[0]),j.required=!0,m(j,"class","svelte-1o8ler7"),m(M,"class","preview svelte-1o8ler7"),f(M,"open",e[7]),m(H,"class","ovo-btn"),m(H,"data-active",e[7]),m(U,"class","ovo-oa-x"),m(V,"class","ovo-btn"),m(V,"type","submit"),m(V,"data-disabled",e[9]),m(T,"class","action svelte-1o8ler7"),m(t,"class","svelte-1o8ler7")},m(s,l){h(s,t,l),p(t,n),p(n,o),z(o,e[1]),p(n,i),p(n,r),z(r,e[2]),p(n,c),p(n,$),z($,e[3]),p(t,b),p(t,j),e[20](j),z(j,e[8]),p(t,C),p(t,M),M.innerHTML=e[11],p(t,L),p(t,T),E(I,T,null),p(T,R),E(N,T,null),p(T,P),p(T,H),p(H,A),p(T,q),p(T,U),p(U,B),p(T,J),p(T,W),p(T,Y),p(T,F),p(F,G),p(F,K),p(F,Q),p(T,Z),p(T,V),p(V,X),ee=!0,te||(ne=[v(o,"input",e[17]),v(r,"input",e[18]),v($,"input",e[19]),v(j,"input",e[21]),v(H,"click",e[22]),v(t,"submit",D(e[15]))],te=!0)},p(e,[t]){(!ee||16&t&&s!==(s=e[4].editor.name))&&m(o,"placeholder",s),2&t&&o.value!==e[1]&&z(o,e[1]),(!ee||16&t&&l!==(l=e[4].editor.email))&&m(r,"placeholder",l),4&t&&r.value!==e[2]&&z(r,e[2]),(!ee||16&t&&w!==(w=e[4].editor.website))&&m($,"placeholder",w),8&t&&z($,e[3]),(!ee||1&t)&&m(j,"placeholder",e[0]),256&t&&z(j,e[8]),(!ee||2048&t)&&(M.innerHTML=e[11]),128&t&&f(M,"open",e[7]);const n={};32&t&&(n.emoji=e[5]),16&t&&(n.locale=e[4]),I.$set(n),(!ee||16&t)&&oe!==(oe=e[4].editor.preview+"")&&g(A,oe),(!ee||128&t)&&m(H,"data-active",e[7]),(!ee||1024&t)&&g(B,e[10]),(!ee||4096&t)&&g(G,e[12]),(!ee||528&t)&&se!==(se=e[9]?`${e[4].editor.waiting}`:`${e[4].editor.submit}`)&&g(X,se),(!ee||512&t)&&m(V,"data-disabled",e[9])},i(e){ee||(y(I.$$.fragment,e),y(N.$$.fragment,e),ee=!0)},o(e){k(I.$$.fragment,e),k(N.$$.fragment,e),ee=!1},d(n){n&&x(t),e[20](null),S(I),S(N),te=!1,O(ne)}}}const Ce=400;function Me(e,t,n){let o,s;R(e,me,(e=>n(16,s=e)));var i=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(s,i){function r(e){try{c(o.next(e))}catch(t){i(t)}}function l(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,l)}c((o=o.apply(e,t||[])).next())}))};let r,{locale:l}=t,{placeholder:c=l.editor.placeholder}=t,{emoji:a=""}=t,u=!1,d=!1,m="",f="",h="",{issuer:p="",issuer_email:v="",issuer_website:g=""}=t;function $(e){const t=r.selectionStart,o=r.selectionEnd;n(8,f=f.substring(0,t)+e+f.substring(o,f.length)),n(6,r.selectionStart=t+a.length,r),n(6,r.selectionEnd=t+a.length,r),r.focus()}Ee.on("refresh",(function(){me.update((()=>null)),n(0,c=l.editor.placeholder),n(8,f=""),n(10,m=""),n(7,u=!1)})),Ee.on("ref",(function(e){$(`#${e} `)}));return e.$$set=e=>{"locale"in e&&n(4,l=e.locale),"placeholder"in e&&n(0,c=e.placeholder),"emoji"in e&&n(5,a=e.emoji),"issuer"in e&&n(1,p=e.issuer),"issuer_email"in e&&n(2,v=e.issuer_email),"issuer_website"in e&&n(3,g=e.issuer_website)},e.$$.update=()=>{256&e.$$.dirty&&n(12,o=function(e){const t=e.match(ke);let n=0;if(!t)return 0;for(let o=0;o<t.length;o++)t[o].charCodeAt(0)>=19968?n+=t[o].length:n+=1;return n}(f)),384&e.$$.dirty&&u&&n(11,h=Oe(f)),65617&e.$$.dirty&&s&&(n(0,c=`${l.comment.reply}#${s.id}`),n(10,m=c),r&&r.focus())},[c,p,v,g,l,a,r,u,f,d,m,h,o,function(e){$(e.detail.text)},function(e){$(`@${e.detail.issuer} `)},function(){return i(this,void 0,void 0,(function*(){if(d)return;let e;if(n(9,d=!0),n(11,h=h||Oe(f)),s){const{cid:t,id:n}=s;e={cid:t||n,rid:t?n:null}}const t={issuer:p,issuer_email:v,issuer_website:g},o=Object.assign(Object.assign({domain:encodeURIComponent(location.host),path:encodeURIComponent(location.pathname),content:h},t),e);localStorage.issuer=JSON.stringify(t);try{s?yield je.postReply(o):yield je.postComment(o)}catch(i){return void alert(i.message)}finally{n(9,d=!1)}alert(l.editor.success),Ee.emit("refresh")}))},s,function(){p=this.value,n(1,p)},function(){v=this.value,n(2,v)},function(){g=this.value,n(3,g)},function(e){H[e?"unshift":"push"]((()=>{r=e,n(6,r)}))},function(){f=this.value,n(8,f)},()=>n(7,u=!u)]}class Le extends i{constructor(e){super(),r(this,e,Me,Se,l,{locale:4,placeholder:0,emoji:5,issuer:1,issuer_email:2,issuer_website:3})}}function Te(e,t){if(e)for(let n=0;n<e.length;n++)t(e[n]),Te(e[n].replies,t)}function Ie(e){let t,n,o=e[1]?`${e[0].sentinal.eol}`:`${e[0].sentinal.loading}`;return{c(){t=a("div"),n=u(o),m(t,"class","ovo-s svelte-1l5g19d")},m(o,s){h(o,t,s),p(t,n),e[3](t)},p(e,[t]){3&t&&o!==(o=e[1]?`${e[0].sentinal.eol}`:`${e[0].sentinal.loading}`)&&g(n,o)},i:j,o:j,d(n){n&&x(t),e[3](null)}}}function Re(e,t,n){let o,{locale:s}=t,{done:i=!1}=t;const r=C(),l=new IntersectionObserver((function(e){e[0].intersectionRatio<=.8||r("visiable",e[0])}),{threshold:[.8]});return A((function(){l.observe(o)})),q((function(){l.disconnect()})),e.$$set=e=>{"locale"in e&&n(0,s=e.locale),"done"in e&&n(1,i=e.done)},[s,i,o,function(e){H[e?"unshift":"push"]((()=>{o=e,n(2,o)}))}]}class Ne extends i{constructor(e){super(),r(this,e,Re,Ie,l,{locale:0,done:1})}}function Pe(e,t=!1){const n=new Date(e),o=(new Date).getTime()-n.getTime();if(o<6e4)return`${Math.ceil(o/1e3)} 秒前`;if(o<36e5)return`${Math.ceil(o/6e4)} 分钟前`;if(o<864e5)return`${Math.ceil(o/36e5)} 小时前`;let s=`${n.getFullYear()}-${n.getMonth()+1}-${n.getDate()}`;return t&&(s+=` ${n.getHours()}:${n.getMinutes()}:${n.getSeconds()}`),s}function ze(e,t,n){const o=e.slice();return o[10]=t[n],o[12]=n,o}function De(e){let t,n,o=e[0],s=[];for(let r=0;r<o.length;r+=1)s[r]=Ae(ze(e,o,r));const i=e=>k(s[e],1,1,(()=>{s[e]=null}));return{c(){for(let e=0;e<s.length;e+=1)s[e].c();t=N()},m(e,o){for(let t=0;t<s.length;t+=1)s[t].m(e,o);h(e,t,o),n=!0},p(e,n){if(111&n){let r;for(o=e[0],r=0;r<o.length;r+=1){const i=ze(e,o,r);s[r]?(s[r].p(i,n),y(s[r],1)):(s[r]=Ae(i),s[r].c(),y(s[r],1),s[r].m(t.parentNode,t))}for(U(),r=o.length;r<s.length;r+=1)i(r);B()}},i(e){if(!n){for(let e=0;e<o.length;e+=1)y(s[e]);n=!0}},o(e){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)k(s[t]);n=!1},d(e){T(s,e),e&&x(t)}}}function He(e){var t;let n,o,s,i,r,l,c=(null==(t=e[10].replies)?void 0:t.length)+"",f=e[1].comment.comment+"";function $(){return e[8](e[12])}return{c(){n=a("span"),o=u(c),s=d(),i=u(f),m(n,"class","ovo-s ovo-a ovo-ptr")},m(e,t){h(e,n,t),p(n,o),p(n,s),p(n,i),r||(l=v(n,"click",$),r=!0)},p(t,n){var s;e=t,1&n&&c!==(c=(null==(s=e[10].replies)?void 0:s.length)+"")&&g(o,c),2&n&&f!==(f=e[1].comment.comment+"")&&g(i,f)},d(e){e&&x(n),r=!1,l()}}}function Ae(e){var t;let n,o,s,i,r,l,c,$,w,b,j,C,M,L,T,I,R,N,P,z,D,H,A,q,U,B,J,W,Y=e[10].issuer+"",F=e[10].id+"",G=Pe(e[10].ctime)+"",K=e[1].comment.reply+"",Q=e[10].content+"";function Z(){return e[7](e[10])}let V=(null==(t=e[10].replies)?void 0:t.length)&&He(e);function X(){return e[9](e[10])}return A=new Be({props:{comments:e[10].replies,locale:e[1]}}),{c(){n=a("article"),o=a("div"),s=a("span"),i=a("a"),r=u(Y),c=d(),$=a("span"),w=u("#"),b=u(F),C=d(),M=a("span"),L=u(G),T=d(),V&&V.c(),I=d(),R=a("span"),N=u(K),P=d(),z=a("div"),D=d(),H=a("div"),_(A.$$.fragment),q=d(),m(i,"href",l=e[10].issuer_website),m(i,"target","_blank"),m(i,"class","svelte-inkkd3"),m(s,"class","ovo-b"),m($,"class","ovo-s ovo-ptr"),m($,"title",j=e[1].comment.reference),m(M,"class","ovo-s"),m(R,"class","ovo-s ovo-r ovo-ptr"),m(o,"class","info svelte-inkkd3"),m(z,"class","content svelte-inkkd3"),m(H,"class","details svelte-inkkd3"),f(H,"open",e[3]&1<<e[12]+1),m(n,"id",U="ovo-"+e[10].id),m(n,"class","svelte-inkkd3"),f(n,"active",e[2]&&e[2].slice(5)===e[10].id)},m(e,t){h(e,n,t),p(n,o),p(o,s),p(s,i),p(i,r),p(o,c),p(o,$),p($,w),p($,b),p(o,C),p(o,M),p(M,L),p(o,T),V&&V.m(o,null),p(o,I),p(o,R),p(R,N),p(n,P),p(n,z),z.innerHTML=Q,p(n,D),p(n,H),E(A,H,null),p(n,q),B=!0,J||(W=[v($,"click",Z),v(R,"click",X)],J=!0)},p(t,s){var c;e=t,(!B||1&s)&&Y!==(Y=e[10].issuer+"")&&g(r,Y),(!B||1&s&&l!==(l=e[10].issuer_website))&&m(i,"href",l),(!B||1&s)&&F!==(F=e[10].id+"")&&g(b,F),(!B||2&s&&j!==(j=e[1].comment.reference))&&m($,"title",j),(!B||1&s)&&G!==(G=Pe(e[10].ctime)+"")&&g(L,G),(null==(c=e[10].replies)?void 0:c.length)?V?V.p(e,s):(V=He(e),V.c(),V.m(o,I)):V&&(V.d(1),V=null),(!B||2&s)&&K!==(K=e[1].comment.reply+"")&&g(N,K),(!B||1&s)&&Q!==(Q=e[10].content+"")&&(z.innerHTML=Q);const a={};1&s&&(a.comments=e[10].replies),2&s&&(a.locale=e[1]),A.$set(a),8&s&&f(H,"open",e[3]&1<<e[12]+1),(!B||1&s&&U!==(U="ovo-"+e[10].id))&&m(n,"id",U),5&s&&f(n,"active",e[2]&&e[2].slice(5)===e[10].id)},i(e){B||(y(A.$$.fragment,e),B=!0)},o(e){k(A.$$.fragment,e),B=!1},d(e){e&&x(n),V&&V.d(),S(A),J=!1,O(W)}}}function qe(e){let t,n,o,s,i=e[0]&&De(e);return{c(){i&&i.c(),t=N()},m(r,l){i&&i.m(r,l),h(r,t,l),n=!0,o||(s=v(window,"hashchange",e[4]),o=!0)},p(e,[n]){e[0]?i?(i.p(e,n),1&n&&y(i,1)):(i=De(e),i.c(),y(i,1),i.m(t.parentNode,t)):i&&(U(),k(i,1,1,(()=>{i=null})),B())},i(e){n||(y(i),n=!0)},o(e){k(i),n=!1},d(e){i&&i.d(e),e&&x(t),o=!1,s()}}}function Ue(e,t,n){let{comments:o=[]}=t,{locale:s}=t,i=location.hash;function r(e){me.set(e)}let l=0;function c(e){n(3,l^=1<<e)}return e.$$set=e=>{"comments"in e&&n(0,o=e.comments),"locale"in e&&n(1,s=e.locale)},[o,s,i,l,function(){const e=location.hash;n(2,i=/#ovo-(\d+|[a-z,0-9]{7})/.test(e)?e:"")},r,c,e=>Ee.emit("ref",e.id),e=>c(e+1),e=>r(e)]}class Be extends i{constructor(e){super(),r(this,e,Ue,qe,l,{comments:0,locale:1})}}var Je={locale:"zh-Hans",editor:{name:"昵称",email:"邮箱",website:"网址",faces:"OvO",preview:"预览",submit:"发布",waiting:"发布中",words:"字",placeholder:"说点什么吧～",success:"发布成功 φ(￣∇￣o)"},comment:{title:"评论",comment:"条评论",reply:"回复",reference:"引用"},sentinal:{loading:"加载中",eol:"到底啦 OvO"}};function We(e){let t,n,o,s,i,r,l,c=e[0].comment.title+"";return r=new Be({props:{comments:e[5],locale:e[0]}}),{c(){t=a("h3"),n=u(c),o=d(),s=u(e[4]),i=d(),_(r.$$.fragment),m(t,"class","svelte-2zuo7e")},m(e,c){h(e,t,c),p(t,n),p(t,o),p(t,s),h(e,i,c),E(r,e,c),l=!0},p(e,t){(!l||1&t)&&c!==(c=e[0].comment.title+"")&&g(n,c),(!l||16&t)&&g(s,e[4]);const o={};32&t&&(o.comments=e[5]),1&t&&(o.locale=e[0]),r.$set(o)},i(e){l||(y(r.$$.fragment,e),l=!0)},o(e){k(r.$$.fragment,e),l=!1},d(e){e&&x(t),e&&x(i),S(r,e)}}}function Ye(e){let t,n,o,s,i,r;const l=[{placeholder:e[1]},{emoji:e[2]},{locale:e[0]},e[6]];let c={};for(let a=0;a<l.length;a+=1)c=J(c,l[a]);n=new Le({props:c});let u=e[5]&&We(e);return i=new Ne({props:{done:e[3],locale:e[0]}}),i.$on("visiable",e[7]),{c(){t=a("section"),_(n.$$.fragment),o=d(),u&&u.c(),s=d(),_(i.$$.fragment),m(t,"class","OvO svelte-2zuo7e")},m(e,l){h(e,t,l),E(n,t,null),p(t,o),u&&u.m(t,null),p(t,s),E(i,t,null),r=!0},p(e,[o]){const r=71&o?W(l,[2&o&&{placeholder:e[1]},4&o&&{emoji:e[2]},1&o&&{locale:e[0]},64&o&&Y(e[6])]):{};n.$set(r),e[5]?u?(u.p(e,o),32&o&&y(u,1)):(u=We(e),u.c(),y(u,1),u.m(t,s)):u&&(U(),k(u,1,1,(()=>{u=null})),B());const c={};8&o&&(c.done=e[3]),1&o&&(c.locale=e[0]),i.$set(c)},i(e){r||(y(n.$$.fragment,e),y(u),y(i.$$.fragment,e),r=!0)},o(e){k(n.$$.fragment,e),k(u),k(i.$$.fragment,e),r=!1},d(e){e&&x(t),S(n),u&&u.d(),S(i)}}}function Fe(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(s,i){function r(e){try{c(o.next(e))}catch(t){i(t)}}function l(e){try{c(o.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,l)}c((o=o.apply(e,t||[])).next())}))};let{locale:s=Je}=t,{placeholder:i=s.editor.placeholder}=t,{emoji:r="https://cdn.jsdelivr.net/gh/DejavuMoe/DejavuMoe/emoji.json"}=t,{server:l="https://www.fastmock.site/mock/112f2e694fa5334c4d698ce22a512405/ovo"}=t,{timeout:c=1e4}=t;je.init({server:l,timeout:c});const a=new Map;let u,d,m,f,h,p;function v(){n(5,f=null),n(5,f=[]),d=-1,n(4,m=0),n(3,u=!1),a.clear()}return v(),A((function(){const e=localStorage.issuer;e&&n(6,p=JSON.parse(e))})),q((function(){console.log("OvO was destroyed")})),Ee.on("refresh",v),e.$$set=e=>{"locale"in e&&n(0,s=e.locale),"placeholder"in e&&n(1,i=e.placeholder),"emoji"in e&&n(2,r=e.emoji),"server"in e&&n(8,l=e.server),"timeout"in e&&n(9,c=e.timeout)},[s,i,r,u,m,f,p,function(e){return o(this,void 0,void 0,(function*(){if(!u){d++;try{h=yield je.getComments({domain:encodeURIComponent(location.host),path:encodeURIComponent(location.pathname),page:d})}catch(e){throw d--,n(3,u=!0),e}n(3,u=h.done),n(5,f=[...f,...h.comments]),n(4,m=0),a.clear(),Te(f,(function({issuer:e,issuer_website:t,issuer_email:o}){n(4,m++,m),e&&a.set(e,{issuer:e,issuer_website:t,issuer_email:o})})),fe.set(a)}}))},l,c]}class Ge extends i{constructor(e){super(),r(this,e,Fe,Ye,l,{locale:0,placeholder:1,emoji:2,server:8,timeout:9})}}function Ke(e){let t,n,o;return{c(){t=a("input"),m(t,"type","checkbox"),m(t,"class","svelte-19wt9bf")},m(s,i){h(s,t,i),t.checked=e[0],n||(o=v(t,"change",e[1]),n=!0)},p(e,[n]){1&n&&(t.checked=e[0])},i:j,o:j,d(e){e&&x(t),n=!1,o()}}}function Qe(e,t,n){let{checked:o=!1}=t;return e.$$set=e=>{"checked"in e&&n(0,o=e.checked)},[o,function(){o=this.checked,n(0,o)}]}class Ze extends i{constructor(e){super(),r(this,e,Qe,Ke,l,{checked:0})}}var Ve={"简体中文":{locale:"zh-Hans",editor:{name:"昵称",email:"邮箱",website:"网址",faces:"OvO",preview:"预览",submit:"发布",waiting:"发布中",words:"字",placeholder:"说点什么吧～",success:"发布成功 φ(￣∇￣o)"},comment:{title:"评论",comment:"条评论",reply:"回复",reference:"引用"},sentinal:{loading:"加载中",eol:"到底啦 OvO"}},English:{locale:"en",editor:{name:"Nickname",email:"Email",website:"Website",faces:"OvO",preview:"Preview",submit:"Submit",waiting:"Waiting",words:"Words",placeholder:"Leave your comments",success:"Success φ(￣∇￣o)"},comment:{title:"Total",comment:"comments",reply:"reply",reference:"reference"},sentinal:{loading:"Loading comments",eol:"You've reached the End OvO"}}};function Xe(e,t,n){const o=e.slice();return o[6]=t[n],o}function et(e){let t,n,o,s=e[6]+"";return{c(){t=a("option"),n=u(s),t.__value=o=e[6],t.value=t.__value},m(e,o){h(e,t,o),p(t,n)},p:j,d(e){e&&x(t)}}}function tt(e){let t,n,o,s,i,r,l,c,f,$,w,b,O,j,C,M,L,I,R,N,P,z,D,A,q=e[0]?"🌑":"🌞";function U(t){e[4](t)}let B={};void 0!==e[0]&&(B.checked=e[0]),O=new Ze({props:B}),H.push((()=>F(O,"checked",U)));let J=Object.keys(Ve),W=[];for(let a=0;a<J.length;a+=1)W[a]=et(Xe(e,J,a));return P=new Ge({props:{locale:e[2],server:nt}}),{c(){t=a("main"),n=a("h1"),n.textContent="OvO",o=d(),s=a("h2"),s.textContent="A Svelte Web Component for Comments",i=d(),r=a("p"),r.innerHTML='Inspired by <a href="https://github.com/DIYgod/OwO" class="svelte-9s02sx">OωO</a>. Available on\n    <a href="https://github.com/ovojs/OvO" class="svelte-9s02sx">GitHub</a>. Docs in\n    <a href="https://github.com/ovojs/OvO/blob/main/README.md" class="svelte-9s02sx">README</a>',l=d(),c=a("div"),f=a("div"),$=a("span"),w=u(q),b=d(),_(O.$$.fragment),C=d(),M=a("div"),L=a("span"),I=d(),R=a("select");for(let e=0;e<W.length;e+=1)W[e].c();N=d(),_(P.$$.fragment),m(n,"class","svelte-9s02sx"),m(r,"class","svelte-9s02sx"),m(f,"class","svelte-9s02sx"),m(R,"class","svelte-9s02sx"),void 0===e[1]&&G((()=>e[5].call(R))),m(M,"class","svelte-9s02sx"),m(c,"class","svelte-9s02sx"),m(t,"class","svelte-9s02sx")},m(a,u){h(a,t,u),p(t,n),p(t,o),p(t,s),p(t,i),p(t,r),p(t,l),p(t,c),p(c,f),p(f,$),p($,w),p(f,b),E(O,f,null),p(c,C),p(c,M),p(M,L),p(M,I),p(M,R);for(let e=0;e<W.length;e+=1)W[e].m(R,null);K(R,e[1]),p(t,N),E(P,t,null),z=!0,D||(A=v(R,"change",e[5]),D=!0)},p(e,[t]){(!z||1&t)&&q!==(q=e[0]?"🌑":"🌞")&&g(w,q);const n={};if(!j&&1&t&&(j=!0,n.checked=e[0],Q((()=>j=!1))),O.$set(n),0&t){let n;for(J=Object.keys(Ve),n=0;n<J.length;n+=1){const o=Xe(e,J,n);W[n]?W[n].p(o,t):(W[n]=et(o),W[n].c(),W[n].m(R,null))}for(;n<W.length;n+=1)W[n].d(1);W.length=J.length}2&t&&K(R,e[1]);const o={};4&t&&(o.locale=e[2]),P.$set(o)},i(e){z||(y(O.$$.fragment,e),y(P.$$.fragment,e),z=!0)},o(e){k(O.$$.fragment,e),k(P.$$.fragment,e),z=!1},d(e){e&&x(t),S(O),T(W,e),S(P),D=!1,A()}}}const nt="http://localhost:5000/api";function ot(e,t,n){let o,s=!1,i="light",r="简体中文";try{i=localStorage.theme,s="dark"===i}catch(l){}return e.$$.update=()=>{if(2&e.$$.dirty&&n(2,o=Ve[r]),9&e.$$.dirty){const{classList:e}=document.querySelector("html");e.remove(i),n(3,i=s?"dark":"light"),e.add(i);try{localStorage.theme=i}catch(l){}}},[s,r,o,i,function(e){s=e,n(0,s)},function(){r=Z(this),n(1,r)}]}new class extends i{constructor(e){super(),r(this,e,ot,tt,l,{})}}({target:document.getElementById("app")});
